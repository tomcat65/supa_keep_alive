# Supabase Multi-Project Monitor

A serverless monitoring solution for multiple Supabase projects deployed on Vercel. The monitor performs health checks by inserting records into a `health_checks` table for each project.

## Features

- Monitor multiple Supabase projects simultaneously
- Automated health checks every 12 hours
- Manual health check endpoint
- Serverless deployment on Vercel
- Secure cron endpoints with authentication

## Prerequisites

- Node.js 14+
- Vercel account
- Supabase projects with `health_checks` table
- Cron from Vercel

### Required Table Structure

Create this table in each Supabase project:

```sql
create table health_checks (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  status text,
  project_name text
);
```

## Environment Variables

Set these in your Vercel dashboard:

```env
PROJECT1_NAME=your-first-project
PROJECT1_URL=your-first-project-url
PROJECT1_ANON_KEY=your-first-project-key

PROJECT2_NAME=your-second-project
PROJECT2_URL=your-second-project-url
PROJECT2_ANON_KEY=your-second-project-key

CRON_SECRET=your-secret-key
```

## Deployment

1. Clone the repository
2. Install dependencies:
```bash
npm install
```

3. Deploy to Vercel:
```bash
vercel
```

## API Endpoints

- `GET /api/monitor`: Manual health check
- `GET /api/cron`: Automated health check (requires authorization header)

## Development

Run locally:
```bash
npm run dev
```

## License

MIT
